

<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<style>
@media (prefers-color-scheme: dark) {
    body {
        background-color: #1c1c1c;
        color: white;
    }
    .markdown-body table tr {
        background-color: #1c1c1c;
    }
    .markdown-body table tr:nth-child(2n) {
        background-color: black;
    }
}
</style>



<link rel="alternate" type="application/rss+xml" href="../../../../feed.xml" title="Hello world">



<link rel="stylesheet" type="text/css" href="../../../../css/main.css">
<link rel="icon" type="image/svg+xml" href="../../../../favicon.svg">

<script type="text/x-mathjax-config">
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\(', '\)']]
  },
  svg: {
    fontCache: 'global',
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="../../../../scripts/tex-svg.js">
</script>

<style>
</style>

<div id="doc" class="container-fluid markdown-body comment-enabled" data-hard-breaks="true">

<!--
  Temporarily disable the color mode switch while we keep light theme only.
<div id="color-mode-switch">
  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
  </svg>
  <input type="checkbox" id="switch" />
  <label for="switch">Dark Mode Toggle</label>
  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
  </svg>
</div>

<script type="text/javascript">
  // Update root html class to set CSS colors
  const toggleDarkMode = () => {
    const root = document.querySelector('html');
    root.classList.toggle('dark');
  }

  // Update local storage value for colorScheme
  const toggleColorScheme = () => {
    const colorScheme = localStorage.getItem('colorScheme');
    if (colorScheme === 'light') localStorage.setItem('colorScheme', 'dark');
    else localStorage.setItem('colorScheme', 'light');
  }

  // Set toggle input handler
  const toggle = document.querySelector('#color-mode-switch input[type="checkbox"]');
  if (toggle) toggle.onclick = () => {
    toggleDarkMode();
    toggleColorScheme();
  }

  // Check for color scheme on init
  const checkColorScheme = () => {
    const colorScheme = localStorage.getItem('colorScheme');
    // Default to light for first view
    if (colorScheme === null || colorScheme === undefined) localStorage.setItem('colorScheme', 'light');
    // If previously saved to dark, toggle switch and update colors
    if (colorScheme === 'dark') {
      toggle.checked = true;
      toggleDarkMode();
    }
  }
  checkColorScheme();
</script>
-->

<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Hello world" />
<meta name="twitter:image" content="http://vitalik.ca/images/icon.png" />


<br>
<h1 style="margin-bottom:7px"> Hello world </h1>
<small style="float:left; color: #888"> 2020 Oct 24 </small>
<small style="float:right; color: #888"><a href="../../../../index.html">See all posts</a></small>
<br> <br> <br>
<title> Hello world </title>

<p>I've long held the suspicion that the internet is not as robust as
many assume it is. There are countless books, articles, and thinkpieces
on this topic so I am surely far from the fist person to hold this view,
but I've hardly engaged with any of the critiques. My suspicion has lied
mostly on the thought that it seems extremely unlikely that any of the
core systems we use today were built to defend against the adversary
models many of us see unfolding in the next few decades.</p>
<p>I won't divulge what I think these adversary models are here, but
what I will do is walk through the journey of a packet from the network
point of view to further understand our current infrastructure. What you
should not expect is a masterful explanation of how the internet works,
but the facts and resources I have learned along the way of undigging
how the internet works. At the end I will opine on the classess of
vulnerabilities, and whether satelite communication can help.</p>
<p>I also feel compelled to say that there are two other latent
motivations for writing this document that have accelerated starting the
journey out of total ignorance into less ignorance. The first is quite
serious. A few weeks ago we saw the first <a
href="https://blog.cloudflare.com/nationwide-internet-shutdown-in-afghanistan/">nation-wide
shutdown of internet in Afghanistan</a>. The second, in numerous
blockchain ecosystems, large amounts of research interest has
increasingly flocked to the <a
href="https://arxiv.org/abs/2504.03588">study of
distributed-systems-based consensus for guranteeing censorship
resistance properties</a>. If an adversary can easily censor at the
underlying layers, then these efforts are somewhat futile, or at least
over promising and under delivering.</p>
<hr />
<h2 id="a-brief-nod-to-the-original-design">A Brief Nod to the Original
Design</h2>
<p>Straight from the design document, "<a
href="https://web.mit.edu/6.033/www/papers/darpa.pdf">The Design
Philosophy of the DARPA Internet Protocols</a>" by David D. Clark posted
in 1988 slightly retroactively to the adoption of the internert, which I
didn't know existed until writing this post,"The fundemental goal for
the DARPA internet architecture is to provide an effective technique for
multiplexed utilization of existing interconnected networks." And due to
the lack of definition for "effective", the design document lays out 7
secondary goals:</p>
<blockquote>
<ol type="1">
<li>Internet communication must continue despite loss of networks or
gateways.</li>
<li>The Internet must support multiple types of communications
service.</li>
<li>The Internet architecture must accommodate a variety of
networks.</li>
<li>The Internet architecture must permit distributed management of its
resources.</li>
<li>The Internet architecture must be cost effective.</li>
<li>The Internet architecture must permit host attachment with a low
level of effort.</li>
<li>The resources used in the Internet architecture must be
accountable.</li>
</ol>
</blockquote>
<p>The interesting thing to note for me is that these "design
requirements" should actually have relatively little impact on the
ability to withstand different adversaries. This means it's very likely
that the flaws I am concerned with are less about the initial
assumptions, and more about implementations. But nonetheless, we
continue on with the journey of a packet.</p>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<tbody>
<tr>
<td>## The Journey of a Packet</td>
</tr>
<tr>
<td>How did the present-article-shaped bits on my laptop make their way
to your screen? I am less interesetd in the specifics of where the bits
are hosted and how they're interpretted, and more the rough shape of
what networks they had to traverse to get from say one country to
another.</td>
</tr>
<tr>
<td>### Background: The Internet as a "Network of Networks"</td>
</tr>
<tr>
<td>The very "inter" in "Internet" signifies that it is not a single
entity, but a collection of independent networks connected together.
Major tech companies, university campuses, and massive bandwidth
providers each run their own network, technically known as an <a
href="https://www.cloudflare.com/learning/network-layer/what-is-an-autonomous-system/"><strong>Autonomous
System (AS)</strong></a>. The number of routable ASNs is on the order of
<a href="https://www.cidr-report.org/as2.0/">~75–90k</a>, depending on
<a href="https://blog.apnic.net/2021/03/19/how-do-we-count-asns/">how
you count</a>.</td>
</tr>
<tr>
<td>The protocol that governs the handoffs between these networks,
including figuring out the best path across this global mesh, is the <a
href="https://www.cloudflare.com/learning/security/glossary/what-is-bgp/"><strong>Border
Gateway Protocol (BGP)</strong></a>. As the <a
href="https://datatracker.ietf.org/doc/html/rfc4271">IETF RFC</a>
describes it, BGP's primary function is to "exchange network
reachability information with other BGP systems." This information
essentially builds the map of the internet.</td>
</tr>
<tr>
<td>But are all Autonomous Systems the same? No, in practice, they form
an unofficial hierarchy based on their scale and how they interconnect.
This structure is built from a <a
href="https://en.wikipedia.org/wiki/Tier_1_network">few key
components</a>:</td>
</tr>
<tr>
<td>* <strong>Points of Presence (PoPs):</strong> These are the physical
data centers where a network provider houses its routers and servers. A
large provider might have hundreds of PoPs around the world, giving them
a "presence" in major cities. * <strong>Internet Exchange Points
(IXPs):</strong> Think of an IXP as a neutral meeting ground. It's a
large data center where hundreds of different networks bring their
equipment to connect directly to one another. This direct connection,
called <strong>peering</strong>, is often cheaper and faster than
sending traffic through a paid provider. * <strong>Tier 2 and Tier 3
Networks:</strong> These are most of the ISPs you know. They have their
own regional or national networks but must pay larger networks to reach
every corner of the global internet. This paid connection is called
<strong>transit</strong>. * <strong>Tier 1 Networks:</strong> At the
very top are the <strong>Tier 1 networks</strong>. These are massive,
globe-spanning backbones with such a comprehensive network that they
typically don't buy transit from anyone. They can reach the entire
internet through free peering agreements with all the other Tier 1
networks.</td>
</tr>
<tr>
<td><img src="https://hackmd.io/_uploads/H10-m75Tgg.png"
alt="image" /></td>
</tr>
<tr>
<td>So to understand the traversal of a packet is to understand its
journey through this hierarchy. A packet leaves your laptop, enters your
local Tier 3 or Tier 2 ISP's AS, and is then guided by BGP routes,
perhaps through an IXP or up to a Tier 1 provider for intercontinental
transit, before resolving back down the hierarchy to finally reach your
friend's laptop.</td>
</tr>
<tr>
<td>### A Side Note: The OSI Model</td>
</tr>
<tr>
<td>Network Engineering has a formal framework for conceptualizing the
different layers of the journey called the <strong>Open Systems
Interconnection (OSI) Model</strong>. The first formalized draft version
of this model was proposed in 1980, stating it's goal: &gt;The universal
need for interconnecting systems from different manufacturers rapidly
became apparent, leading reation of subcommittee 16 with the objective
to come up with standards required for "Open Systems Interconnection."
The term "open" was chosen to emphasize the fact that by conforming to
those international standards, a system will be open to all other
systems obeying the same standards throughout the world.</td>
</tr>
<tr>
<td><a href="https://datageneral.co/osi-model/">Today, the OSI model's
practical purpose is</a> &gt; a seven-layer framework developed by the
ISO to standardize and explain how data travels through a network. These
layers each have distinct roles, from physical transmission to end-user
application communication, ensuring data is reliably transmitted and
understood.</td>
</tr>
<tr>
<td>Your laptop talking to your router and the physical undersea cables
we'll discuss later map to <strong>Layer 1 (The Physical
Layer)</strong>, while the routing protocols like BGP and IP operate at
<strong>Layer 3 (The Network Layer)</strong>. A full deep-dive is beyond
the scope of this post, but understanding this layered structure is a
valuable exercise for anyone thinking seriously about network
architecture and its vulnerabilities. Check out <a
href="https://datageneral.co/osi-model/">this resource</a> to learn
more.</td>
</tr>
<tr>
<td><img src="https://hackmd.io/_uploads/BJROgX5pgl.png"
alt="image" /></td>
</tr>
<tr>
<td>### A Real-World Trace</td>
</tr>
<tr>
<td>With this layered model in mind, we can see the lower layers in
action using a command-line tool called <code>traceroute</code>. It
shows the hop-by-hop path a packet takes to its destination. Using a <a
href="https://gist.github.com/dmarzzz/e3acfeb5a73fcb0f44ae38d8ecd04dab">python
script</a> to enrich the results, here is the path from my laptop at a
cafe in Tokyo to <code>google.com</code>.</td>
</tr>
<tr>
<td>| Hop | IP | ASN | Holder | Role / Function | Notes | | — | — | — |
— | — | — | | 1 | 10.19.163.254 | | | <strong>Customer Gateway</strong>
| Your home or local router / access CPE. First hop into the ISP. | | 2
| 150.249.207.1 | AS2527 | SO-NET Sony Network Communications Inc. |
<strong>Access / Regional Aggregation Router</strong> | Local Sony/NURO
access node in Tokyo (<code>tkyc</code> indicates Tokyo region). | | 3 |
92.203.133.118 | AS2527 | SO-NET Sony Network Communications Inc. |
<strong>Aggregation / Metro Backbone</strong> | Still Sony; consolidates
traffic from multiple access routers. | | 4 | 219.98.228.225 | AS2527 |
SO-NET Sony Network Communications Inc. | <strong>Backbone / Core
Router</strong> | Internal Sony backbone, likely between Tokyo PoPs. | |
5 | 202.213.193.53 | AS2527 | SO-NET Sony Network Communications Inc. |
<strong>Backbone / Core Router</strong> | Core link within Sony's
national network. | | 6 | 202.213.193.85 | AS2527 | SO-NET Sony Network
Communications Inc. | <strong>Backbone / Core Router</strong> |
Redundant path in same core network block. | | 7 | 202.213.193.53 |
AS2527 | SO-NET Sony Network Communications Inc. | <strong>Backbone /
Core Router</strong> | Duplicate of hop 5 — same core segment responding
again. | | 8 | 120.74.58.43 | AS2527 | SO-NET Sony Network
Communications Inc. | <strong>Backbone / Edge Transit</strong> | Moving
toward Sony's edge routers that peer externally. | | 9 | 219.98.234.43 |
AS2527 | SO-NET Sony Network Communications Inc. | <strong>Backbone /
Edge Transit</strong> | Alternate edge path within Sony backbone. | | 10
| 120.74.58.43 | AS2527 | SO-NET Sony Network Communications Inc. |
<strong>Backbone / Edge Transit</strong> | Same as hop 8, likely
load-balanced reply. | | 11 | 202.213.198.74 | AS2527 | SO-NET Sony
Network Communications Inc. | <strong>Peering Edge Router (IXP
handoff)</strong> | Sony's peering edge handing traffic to Google —
probably at JPNAP or BBIX Tokyo. | | 12 | 216.239.59.33 | AS15169 |
GOOGLE | <strong>Google Ingress Router (Peering Edge)</strong> |
<strong>First Google hop</strong>, receiving traffic from Sony. | | 13 |
172.253.66.203 | AS15169 | GOOGLE | <strong>Google Core / Regional
Backbone</strong> | Inside Google's Tokyo region network. | | 14 |
108.170.235.121 | AS15169 | GOOGLE | <strong>Google Internal
Router</strong> | Internal hop en route to service front-end. | | 15 |
172.217.175.46 | AS15169 | GOOGLE | <strong>Destination Server
(Frontend)</strong> | Google's edge server responding to your request.
|</td>
</tr>
<tr>
<td>As you can see, the packet spends its first 11 hops entirely within
my ISP's network (<strong>AS2527 - Sony</strong>). At hop 12, the
critical handoff occurs: the packet leaves Sony's network and enters
Google's (<strong>AS15169</strong>), where it is routed internally to
the destination server. This is a real-world example of peering between
two Autonomous Systems.</td>
</tr>
<tr>
<td>As a side note, some may find it interesting how
<code>traceroute</code> actually works. It works by exploiting the "TTL"
(Time To Live) field in IP packets. "IP Packets" or "Internet Protocol
Packets" are themselves defined in the "Darpa Internet Protocol" in <a
href="https://www.rfc-editor.org/rfc/rfc791.html">RFC-791</a>. When this
TTL reaches 0, a router will drop the packet and return an "ICMP Time
Exceeded" message to the original IP. So <code>traceroute</code>
"exploits" this feature by making requests and incrementing the "TTL"
field such that each hop along the way it will return the IP of each
host along the path of it's destination.</td>
</tr>
<tr>
<td>### The Generalized Path</td>
</tr>
<tr>
<td>Building on that real-world trace, we can create a generalized model
for how a packet travels from one continent to another. This theoretical
path is illustrated in the diagram below and broken down into four key
stages.</td>
</tr>
<tr>
<td>1. <strong>The Local Network</strong>: It all starts when you hit
‘send'. Your laptop sends the data packet over Wi-Fi
(<code>802.11</code>) to your local router, which sends it through your
modem (<a
href="https://www.geeksforgeeks.org/computer-networks/ethernet-frame-format/">ethernet</a>)
to your ISP's local access node (<a
href="https://www.netgear.com/images/pdf/DOCSIS31WhitePaper.pdf">DOCSIS</a>/<a
href="https://www.cisco.com/c/en/us/support/docs/switches/catalyst-pon-series/216230-understand-gpon-technology.html">GPON</a>).
- <em>Surprisingly the specification for <code>802.11</code> and
<code>ethernet</code> are not as easy to get ahold of as you would
expect.</em></td>
</tr>
<tr>
<td>2. <strong>The Regional ISP</strong>: Inside your ISP's network,
your packet travels through aggregation and core routers. Here, a DNS
query resolves the destination's IP address. This is a primary
chokepoint where an ISP or government can deploy <strong>Deep Packet
Inspection (DPI)</strong> tools.</td>
</tr>
<tr>
<td>3. <strong>The Global Backbone</strong>: At the edge of its network,
your ISP uses BGP to decide the best onward path. It exchanges traffic
with other networks, either through direct connections or at an
<strong>Internet Exchange Point (IXP)</strong>. For international
traffic, the packet is handed to a <strong>Tier 1</strong> transit
provider and sent across an undersea cable.</td>
</tr>
<tr>
<td>4. <strong>Arrival and Delivery</strong>: After crossing the ocean,
the packet lands and is handed off to the destination's local ISP. It
traverses their regional network, potentially passing through another
DPI checkpoint, and is finally delivered to the destination laptop.</td>
</tr>
<tr>
<td><!-- end list --></td>
</tr>
<tr>
<td>```mermaid graph TD</td>
</tr>
<tr>
<td>%% ===== Local - Origin ===== subgraph "Local - Origin"
A["fa:fa-laptop Laptop"] B["fa:fa-wifi WiFi Router"] M_US["Modem or
ONT"] ACC_US["Local Access Node"] A –&gt;|"802.11"| B –&gt;|"Ethernet"|
M_US –&gt;|"DOCSIS/GPON"| ACC_US end</td>
</tr>
<tr>
<td>%% ===== Regional - Origin ISP ===== subgraph "Regional - Origin
ISP" EDGE_US["fa:fa-network-wired ISP Edge Router"] DPI_US["fa:fa-shield
Gov/ISP DPI"] DNS["fa:fa-globe DNS Resolver"] CDN["fa:fa-server CDN"]
ACC_US –&gt;|"IP/MPLS"| EDGE_US –&gt;|"BGP"| DPI_US EDGE_US –&gt;|"DNS"|
DNS EDGE_US –&gt;|"TLS/QUIC"| CDN end</td>
</tr>
<tr>
<td>%% ===== Global Transit ===== subgraph "Global Transit"
IXP_US["fa:fa-exchange-alt IXP"] TIER1["fa:fa-project-diagram Tier 1
Transit"] SEA["fa:fa-water Undersea Cable"] DPI_US –&gt;|"IP Transit"|
IXP_US –&gt;|"IP Transit"| TIER1 –&gt;|"Optical"| SEA end</td>
</tr>
<tr>
<td>%% ===== Regional - Destination ===== subgraph "Regional -
Destination ISP" LAND["fa:fa-anchor Landing Station"] RTR["fa:fa-route
Regional Transit"] EDGE_AF["fa:fa-network-wired Friend's ISP Edge
Router"] DPI_AF["fa:fa-shield Gov/ISP DPI"] SEA –&gt;|"Optical"| LAND
–&gt;|"IP/MPLS"| RTR –&gt;|"IP/MPLS"| EDGE_AF –&gt;|"IP Filter"| DPI_AF
end</td>
</tr>
<tr>
<td>%% ===== Local - Destination ===== subgraph "Local - Destination"
ACC_AF["Local Access Node"] M_AF["Modem or ONT"] R_AF["fa:fa-wifi WiFi
Router"] L_AF["fa:fa-laptop Friend's Laptop"] DPI_AF –&gt;|"IP/MPLS"|
ACC_AF –&gt;|"DOCSIS/GPON"| M_AF –&gt;|"Ethernet"| R_AF –&gt;|"802.11"|
L_AF end</td>
</tr>
<tr>
<td>%% ===== App Layer (Context) ===== subgraph "Messaging Service (App
Layer)" APP["fa:fa-server App Servers"] E2EE["fa:fa-lock End-to-End
Encryption"] CDN –&gt;|"TLS/QUIC"| APP –&gt;|"E2EE Payload"| E2EE
end</td>
</tr>
<tr>
<td>%% ===== Styles ===== style A
fill:#c9ffc9,stroke:#333,stroke-width:2px style L_AF
fill:#c9ffc9,stroke:#333,stroke-width:2px style APP
fill:#add8e6,stroke:#333,stroke-width:2px style E2EE
fill:#add8e6,stroke:#333,stroke-width:2px style DPI_US
fill:#ffcccb,stroke:#a00,stroke-width:2px style DPI_AF
fill:#ffcccb,stroke:#a00,stroke-width:2px style EDGE_US
fill:#fff5cc,stroke:#333,stroke-width:1.5px style EDGE_AF
fill:#fff5cc,stroke:#333,stroke-width:1.5px ```</td>
</tr>
<tr>
<td>This entire journey, involving dozens of pieces of hardware across
multiple administrative and national domains, happens in milliseconds.
And as any good decentralization analysis teaches us, each step
represents a potential point of failure or control.</td>
</tr>
</tbody>
</table>
<h2 id="mapping-the-vulnerabilities">Mapping the Vulnerabilities</h2>
<p>For the rest of this post I will break down the points of failure
into three different categories: the political, the logical, and the
brutally physical.</p>
<ul>
<li>There's the <strong>political layer</strong>, where a group of
people (i.e. governement or rebellion etc) can simply order a handful of
local ISPs to shut down, effectively unplugging a country from the
world.</li>
<li>There's the <strong>logical layer</strong>, where the internet's own
routing and naming protocols, built on decades-old assumptions of trust,
can be manipulated to misdirect or spy on traffic.</li>
<li>And finally, there's the <strong>physical layer</strong>: the
simple, tangible fact that our global data flows through a few hundred
vulnerable cables resting on the ocean floor.</li>
</ul>
<p>The following sections explore each of these threat vectors in
detail.</p>
<hr />
<h2 id="the-political-layer-the-power-of-the-switch">The Political
Layer: The Power of the Switch</h2>
<p>In the abstract, this layer touches anything where a human in the
loop can influence the availability, reliability, or privacy of the
system. Typically this looks like the exercise of raw state power.
Centralized authorities can leverage their legal and coercive control
over the infrastructure within their borders to directly manipulate.</p>
<h3 id="the-off-switch-nationwide-shutdowns">The "Off Switch":
Nationwide Shutdowns</h3>
<p>The most blunt instrument of control is a complete network shutdown.
We've seen this tactic deployed during protests and political unrest in
numerous countries. A striking, large-scale example of this occurred on
Monday, September 29, 2025, when Afghanistan experienced a near-total
internet blackout. By compelling the handful of ISPs operating within
the country to cease BGP announcements and shut down services, the
authorities effectively severed the entire nation from the global
internet, as detailed in <a
href="https://blog.cloudflare.com/nationwide-internet-shutdown-in-afghanistan/">reports
from network observers like Cloudflare</a>.</p>
<figure>
<img src="https://hackmd.io/_uploads/BJbZV0F6gl.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<p>No matter how "global" we think the internet is, the "last mile" is
almost always controlled by a small number of local providers who are
subject to the laws of power.</p>
<h3 id="surgical-strikes-deep-packet-inspection-dpi">Surgical Strikes:
Deep Packet Inspection (DPI)</h3>
<p>While nationwide shutdowns are a blunt instrument, a far more subtle
threat operates at this layer: <strong>Deep Packet Inspection
(DPI)</strong>. While the tool itself is technical, but its power is
political. It's a surveillance capability deployed by an authority, like
a government compelling an ISP, to enforce policy on network traffic.
It's suspected that DPI is one of many tools in the "<a
href="https://www.usenix.org/publications/loginonline/measuring-great-firewall%E2%80%99s-multi-layered-web-filtering-apparatus">Great
Firewall's Multi-layered Web Filtering Apparatus</a>".</p>
<p>While E2EE protects your message's content, DPI allows network
operators to inspect the metadata of your data packets. Even with modern
encryption like TLS 1.3, the initial "handshake" to a website happens in
the open. This exposes a critical piece of metadata: the <strong>Server
Name Indication (SNI)</strong>, which reveals the name of the website
you are connecting to.</p>
<p>Governments and ISPs can use the visibility of SNI and other metadata
for a range of activities, from throttling specific types of traffic to
outright blocking access to certain IPs or services.</p>
<ul>
<li><strong>Legal Frameworks</strong>: The U.S. <a
href="https://www.fcc.gov/calea"><strong>Communications Assistance for
Law Enforcement Act (CALEA)</strong></a> requires covered providers to
maintain lawful intercept capability; it does not mandate application
‘backdoors.' Content interception still requires legal process.
Similarly, <a
href="https://www.google.com/search?q=https://www.aclu.org/issues/national-security/privacy-and-surveillance/fisa-section-702">Section
702 of the FISA Amendments Act</a> provides broad authority for
surveillance.</li>
<li><strong>Surveillance Programs</strong>: The <a
href="https://en.wikipedia.org/wiki/Global_surveillance_disclosures_(2013%E2%80%93present)">global
surveillance disclosures of 2013</a> by Edward Snowden demonstrated that
intelligence agencies engage in large-scale collection of internet
metadata. Upstream collection on backbone links (e.g., via provider
cooperation) was documented; this is DPI-adjacent even if not branded as
such.</li>
</ul>
<p>For a comprehensive report, check out the FTC's "<a
href="https://www.ftc.gov/system/files/documents/reports/look-what-isps-know-about-you-examining-privacy-practices-six-major-internet-service-providers/p195402_isp_6b_staff_report.pdf">A
Look At What ISPs Know About You: Examining the Privacy Practices of Six
Major Internet Service Providers</a>".</p>
<p>One ray of hope is <a
href="https://support.mozilla.org/en-US/kb/understand-encrypted-client-hello"><strong>Encrypted
Client Hello (ECH)</strong></a>, a protocol designed fix SNI-like
metadata leakage. ECH encrypts the first "hello" message, hiding your
destination and making it much harder for network observers to track
which sites you visit. Adoption is still very early.</p>
<hr />
<h2 id="the-logical-layer-manipulating-the-map">The Logical Layer:
Manipulating the Map</h2>
<p>The vulnerabilities in this layer exist because its core
protocols—especially BGP and DNS—were designed in the 1980s and 90s for
a much smaller, more cooperative internet. They were fundamentally built
on an assumption of trust that has long since broken down. They lack
built-in mechanisms to cryptographically verify the information they
receive.</p>
<p>This "trust-by-default" architecture means:</p>
<ul>
<li>For <strong>BGP</strong>, when one Autonomous System announces a
path to another, the protocol's default behavior is simply to believe
it. It's like taking a stranger's word for directions without checking a
map.</li>
<li>For <strong>DNS</strong>, the original system had no way to
guarantee a response was authentic. When you ask for a website's IP
address, you have to trust that the answer hasn't been forged by an
attacker.</li>
</ul>
<p>This assumption of cooperation, not hostility, is the central
vulnerability of the logical layer. Adversaries can exploit this trust
to manipulate the internet's own map, often invisibly to the
end-user.</p>
<h3 id="bgp-hijacks-route-leaks">BGP Hijacks &amp; Route Leaks</h3>
<p>The most common manifestation of this trust vulnerability is a
<strong>BGP hijack</strong>, where an attacker falsely announces that
they are the legitimate destination for traffic they don't own. The
version of BGP used universally today, <strong>BGPv4</strong>, is the
standard that contains this vulnerability; its design is what allows
hijacks to occur.</p>
<p>The BGP system operates on a "trust-by-default" model, which is the
opposite of a capability system. It is a world where anyone could walk
up to any car and say, "The owner said I could borrow this," and you'd
have to take their word for it. This is why BGP hijacks are so easy as
there was no verifiable proof of authority for some time.</p>
<p>The modern security fix is not a new version of BGP, but a parallel
system called <strong><a
href="https://en.wikipedia.org/wiki/Resource_Public_Key_Infrastructure">Resource
Public Key Infrastructure</a> (RPKI)</strong>. Think of it as adding a
notarized deed to a land claim. Network owners can publish a
cryptographically signed record called a <strong><a
href="https://www.arin.net/resources/manage/rpki/roa_request/">Route
Origin Authorization</a> (ROA)</strong>, which publicly declares, "My AS
is the only one authorized to originate routes for this specific block
of IP addresses."</p>
<p>This allows any network operator to automatically validate incoming
BGP announcements, rejecting fraudulent ones that don't match the public
ROA. It directly combats BGP hijacking by replacing blind trust with
verifiable, cryptographic proof. While RPKI adoption is growing, it is
not yet universal, leaving significant parts of the internet
vulnerable.</p>
<h3 id="dns-manipulation">DNS Manipulation</h3>
<p>Attackers can block access or redirect users by poisoning the cache
of recursive DNS resolvers or taking over authoritative nameservers.
<strong>Mitigation</strong>: <a
href="https://www.google.com/search?q=https://www.cloudflare.com/learning/dns/dns-security/what-is-dnssec/"><strong>DNSSEC</strong></a>
provides a similar cryptographic validation for DNS responses, while
encrypted protocols like <strong>DNS-over-HTTPS (DoH)</strong> and
<strong>DNS-over-TLS (DoT)</strong> protect the query itself from being
snooped on or tampered with in transit.</p>
<h3 id="ixp-peering-fabric-outages">IXP &amp; Peering Fabric
Outages</h3>
<p>Over-reliance on a single IXP or a small number of peering partners
can create concentrated points of failure, leading to regional brownouts
if they go down. In 2013, during the <a
href="https://blog.cloudflare.com/the-ddos-that-almost-broke-the-internet/">Spamhaus
DDoS incident</a>, attackers reportedly pivoted to targeting major IXP
interconnects in an attempt to disrupt peering routes. Although the
exchanges remained operational due to massive overcapacity and robust
defenses, the incident highlighted their strategic importance as
targets. <strong>Mitigation</strong>: <strong>Multihoming</strong>
across multiple IXPs and transit carriers provides path diversity and
resilience.</p>
<p>Data and monitoring of such events are available from sources like <a
href="https://stat.ripe.net/">RIPEstat</a>, <a
href="https://www.caida.org/">CAIDA</a>, <a
href="https://ooni.org/">OONI</a>, and <a
href="https://radar.cloudflare.com/">Cloudflare Radar</a>.</p>
<hr />
<h2 id="the-physical-layer-brute-force-fragility">The Physical Layer:
Brute Force Fragility</h2>
<p>Beneath all the protocols and politics lies the physical reality of
the internet: a network of tangible, vulnerable hardware. Active
censorship is not required when the underlying infrastructure can be
disrupted or destroyed.</p>
<h3 id="the-undersea-cable-weakness">The Undersea Cable Weakness</h3>
<p>Over 95% of all transcontinental data traffic travels through a few
hundred <a href="https://www.submarinecablemap.com/">fiber-optic
submarine cables</a> laid across the ocean floor. This makes these
cables incredibly high-value strategic assets and, simultaneously,
highly vulnerable targets, as detailed in reports by organizations like
<a
href="https://www.csis.org/analysis/safeguarding-subsea-cables-protecting-cyber-infrastructure-amid-great-power-competition">CSIS</a>.
<img src="https://hackmd.io/_uploads/rJyXLMqaxl.png"
alt="Screenshot 2025-10-13 at 3.02.57 PM" /></p>
<ul>
<li><strong>Espionage and Sabotage</strong>: State actors are acutely
aware of this vulnerability. Russian naval assets, like the spy ship <a
href="https://www.google.com/search?q=https://www.forbes.com/sites/hisutton/2021/08/21/how-russias-most-sinister-spy-ship-yantar-is-making-a-splash/"><em>Yantar</em></a>,
equipped with deep-sea submersibles, have been observed loitering near
critical cable routes, raising alarms about potential tapping or cutting
operations in a conflict scenario.</li>
<li><strong>Supply Chain Risks</strong>: The maintenance of these cables
presents another vector of risk. For instance, state-controlled
companies repair cables owned by major U.S. tech firms. This creates
opportunities for installing backdoors, mapping sensitive military
communication links, or simply denying repairs during a geopolitical
crisis.</li>
</ul>
<p>The legal framework for protecting these cables in international
waters is fragmented and weak, leaving the backbone of our global
economy and communication system alarmingly exposed.</p>
<h3 id="hardware-interdiction-and-supply-chain-exploitation">Hardware
Interdiction and Supply-Chain Exploitation</h3>
<p>Beyond purely logical attacks, a more insidious class of threats
targets the <strong>hardware supply chain</strong> itself. Intelligence
agencies have historically exploited this layer to gain persistent
access to target networks.</p>
<p>According to multiple investigative reports and leaked documents, the
U.S. <strong>NSA and CIA</strong> conducted interdiction operations
during the early 2010s — physically intercepting or modifying hardware
in transit to install covert implants before devices reached their final
destination. This practice is described in <em>The Guardian</em>'s
analysis in Glenn Greenwald's article, "<a
href="https://www.theguardian.com/books/2014/may/12/glenn-greenwald-nsa-tampers-us-internet-routers-snowden">How
the NSA tampers with US-made internet routers</a>". And it's echoed in
Amnesty International's <em><a
href="https://www.amnesty.nl/content/uploads/2015/06/two_years_after_snowden_final_report_en_a4.pdf">Two
Years After Snowden</a></em> report, which explicitly mentions
"interdicting shipments of computer hardware ... altering the hardware."
Some allege Edward Snowden himself discovered signs of such tampering on
his own router hardware.</p>
<p>Quintus et al point towards a large design space of "<a
href="https://writings.flashbots.net/ZTEE2-Supply-Chains">Zero Trust
Supply Chains</a>" aimed at mitigating these concerns with verifiable
chip design, decentralized attestation services, and much more.</p>
<h3 id="environmental-and-natural-disruptions">Environmental and Natural
Disruptions</h3>
<p>Even without malicious intent, the <strong>physical
geography</strong> of the internet creates fragility. Undersea and
terrestrial fiber routes are routinely disrupted by <strong>natural
disasters</strong>, from earthquakes off the coast of Taiwan — such as
the <a
href="https://www.submarinenetworks.com/en/nv/news/cables-cut-after-taiwan-earthquake-2006">2006
Hengchun earthquake that severed multiple Asia-Pacific submarine
cables</a> — to more recent events, e.g. in 2023 when <a
href="https://www.reuters.com/world/asia-pacific/taiwan-coast-guard-says-investigation-damaged-undersea-cable-stymied-by-weather-2025-01-07/">two
undersea cables connecting Taiwan's Matsu islands were cut, isolating
local internet access</a>.</p>
<p><img src="https://hackmd.io/_uploads/HJUlQepTlx.png" alt="image" />
<em>Submarine Cables Cut after Taiwan Earthquake in Dec 2006</em></p>
<hr />
<h2 id="is-satellite-internet-the-answer">Is Satellite Internet the
Answer? 🛰️</h2>
<p>With terrestrial networks so vulnerable, it's natural to look to the
skies. <a
href="https://en.wikipedia.org/wiki/Satellite_Internet_constellation">Low-Earth
Orbit (LEO) satellite constellations</a> like <a
href="https://www.starlink.com/">Starlink</a> seem to offer a path to
bypassing local chokepoints. If your local ISP is shut down, can't you
just point a dish at a satellite?</p>
<p>Yes, but with major caveats. Satellite internet is a powerful tool
for resilience and coverage, but it is not a replacement for the raw
capacity of fiber. The physics are unforgiving.</p>
<p>The maximum throughput of a communication channel is described by the
<a
href="https://en.wikipedia.org/wiki/Shannon%E2%80%93Hartley_theorem"><strong>Shannon-Hartley
theorem</strong></a>:</p>
<p><span class="math display">Channel
Capacity = bandwidthlog<sub>2</sub>(1 + SNR)</span></p>
<p>Where <span class="math inline">SNR</span> is the signal-to-noise
ratio. So fiber will always win on raw throughput:</p>
<ol type="1">
<li><strong>Bandwidth (B)</strong>: A single fiber-optic cable can use
hundreds of different light frequencies simultaneously, giving it access
to terahertz of optical spectrum. A satellite is constrained by a
comparatively tiny slice of licensed radio frequency (RF) spectrum.</li>
<li><strong>Signal-to-Noise Ratio (SNR)</strong>: A signal sent through
space suffers from immense <strong>Free-Space Path Loss (FSPL)</strong>,
which weakens it dramatically. Fiber optic cables regenerate the signal
with amplifiers every ~80 km, keeping the SNR extremely high.</li>
</ol>
<p>Think Mb/s–Gb/s per RF link vs Tb/s per fiber pair, a <span
class="math inline">10<sup>3</sup></span>–<span
class="math inline">10<sup>6</sup>×</span> gap depending on what you
compare (per-flow, per-beam, or aggregate). So satellites may become a
crucial part of a resilient internet architecture, providing an
alternative path when terrestrial routes fail. But they cannot carry the
firehose of data that the global backbone requires. NASA is performing
<a
href="https://www.jpl.nasa.gov/news/nasas-laser-comms-demo-makes-deep-space-record-completes-first-phase/">tests
to use point-to-point optical communication through the use of
lasers</a>, but this will likely never replace our uplink from ground to
a satelite.</p>
<hr />
<h2 id="conclusion-the-new-adversary-model">Conclusion: The New
Adversary Model</h2>
<p>While I wont defend this statement vigorously, it does seem the
"adversary model" at the base of the internet is not actually the issue.
It is more so the implemenation of your connection into the internet,
and how it connects to your destination which need a specification with
a stronger adversary model. If we want to gurantee that 100% of the time
that you try to reach country A through country B with low bandwidth
messaging, then it likely needs many different physical paths to accept
such traffic, as well as transmit it. The future may include a
combination of multicasting to many different paths to avoid reliance on
one, including the use of satelite communication and more. As a rule of
thumb, we should likely look to principles for designing such
infastructure which look something like:</p>
<ul>
<li><strong>The Local Network is Not Neutral.</strong> The "last mile"
ISP is not a simple, neutral pipe. We must assume it is a potential
agent of control, subject to the legal and political pressures of its
jurisdiction. Any packet entering or exiting a national border is
subject to inspection, filtering, or complete blockage.</li>
<li><strong>The Global Map is Malleable.</strong> The internet's core
routing protocols, like BGP and DNS, were built on a foundation of trust
that no longer holds. We must assume that the path our data takes can be
maliciously altered to reroute, monitor, or drop our traffic without our
knowledge.</li>
<li><strong>Physical Chokepoints are Targets.</strong> The physical
infrastructure of the internet is not an invulnerable, decentralized
mesh. We must proactively assume that its most critical chokepoints,
especially the handful of undersea cables connecting continents, are
high-value targets that are unreliable in a geopolitical conflict.</li>
</ul>
<p>For decades, we have focused on making the message unreadable. The
next great challenge is to make the medium unstoppable. The level of
pessimissm we have for the future should inform the architecture, but
the optimism we have for humanity should guide it's undertaking.</p>
 </div> 